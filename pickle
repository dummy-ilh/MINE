import pickle
from transformers import AutoModelForSequenceClassification, AutoTokenizer

# Load a pre-trained model checkpoint and tokenizer
model = AutoModelForSequenceClassification.from_pretrained('./checkpoint')
tokenizer = AutoTokenizer.from_pretrained('./model')

# Choose a file name for the pickle file
model_filename = "trained_model.pkl"

# Serialize and save the model and tokenizer to a pickle file
with open(model_filename, "wb") as model_file:
    pickle.dump((model, tokenizer), model_file)

# To load the pickled model and tokenizer back into memory:
with open(model_filename, "rb") as model_file:
    loaded_model, loaded_tokenizer = pickle.load(model_file)

# Now, 'loaded_model' and 'loaded_tokenizer' contain the trained model and tokenizer, respectively
