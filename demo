import time, json, argparse
from selenium import webdriver
from selenium.webdriver.common.by import By

# --- Parse args for flexible data input ---
parser = argparse.ArgumentParser()
parser.add_argument("--data", required=True, help="Path to JSON with form values")
args = parser.parse_args()

with open(args.data) as f:
    form_data = json.load(f)

# --- Chrome setup ---
options = webdriver.ChromeOptions()
options.add_argument("--start-maximized")
driver = webdriver.Chrome(options=options)

def highlight(el):
    driver.execute_script("arguments[0].style.border='3px solid red'", el)
    time.sleep(1)

try:
    driver.get("http://localhost:8501")
    time.sleep(2)  # wait for app to load

    # Example: Fill "Name"
    name_box = driver.find_element(By.XPATH, "//input[@aria-label='Name']")
    highlight(name_box)
    name_box.send_keys(form_data["name"])
    time.sleep(1)

    # Example: Fill "Email"
    email_box = driver.find_element(By.XPATH, "//input[@aria-label='Email']")
    highlight(email_box)
    email_box.send_keys(form_data["email"])
    time.sleep(1)

    # Example: Fill "Age"
    age_box = driver.find_element(By.XPATH, "//input[@aria-label='Age']")
    highlight(age_box)
    age_box.send_keys(str(form_data["age"]))
    time.sleep(1)

    # Example: Comments textarea
    comments = driver.find_element(By.TAG_NAME, "textarea")
    highlight(comments)
    comments.send_keys(form_data["comments"])
    time.sleep(1)

    # Click submit button
    submit = driver.find_element(By.XPATH, "//button[contains(., 'Submit')]")
    highlight(submit)
    submit.click()
    time.sleep(2)

    print("✅ Demo complete – leave Chrome open so audience sees result")

finally:
    # Don’t auto-close so the audience can see the result
    pass
{
  "name": "Alice Example",
  "email": "alice@example.com",
  "age": 30,
  "comments": "This is an automated demo of the Streamlit app!"
}
